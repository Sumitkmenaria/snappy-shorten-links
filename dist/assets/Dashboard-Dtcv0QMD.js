import{c as p,r as l,j as e,k as i,u as O,l as D,m as F,s as y}from"./index-6xa47Mhh.js";import{B as o,C as N,a as g,b as w,d as k,c as z}from"./card-udcm7_Nx.js";import{U as B,C as V}from"./URLShortener-DDVjTOlQ.js";import{E as A}from"./external-link-BtZOomGx.js";import"./index-Cta8OiU0.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=p("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=p("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=p("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),C=l.forwardRef(({className:s,...a},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:i("w-full caption-bottom text-sm",s),...a})}));C.displayName="Table";const L=l.forwardRef(({className:s,...a},t)=>e.jsx("thead",{ref:t,className:i("[&_tr]:border-b",s),...a}));L.displayName="TableHeader";const T=l.forwardRef(({className:s,...a},t)=>e.jsx("tbody",{ref:t,className:i("[&_tr:last-child]:border-0",s),...a}));T.displayName="TableBody";const $=l.forwardRef(({className:s,...a},t)=>e.jsx("tfoot",{ref:t,className:i("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a}));$.displayName="TableFooter";const j=l.forwardRef(({className:s,...a},t)=>e.jsx("tr",{ref:t,className:i("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",s),...a}));j.displayName="TableRow";const c=l.forwardRef(({className:s,...a},t)=>e.jsx("th",{ref:t,className:i("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...a}));c.displayName="TableHead";const d=l.forwardRef(({className:s,...a},t)=>e.jsx("td",{ref:t,className:i("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...a}));d.displayName="TableCell";const q=l.forwardRef(({className:s,...a},t)=>e.jsx("caption",{ref:t,className:i("mt-4 text-sm text-muted-foreground",s),...a}));q.displayName="TableCaption";const W=()=>{const[s,a]=l.useState([]),[t,R]=l.useState(!0),[m,u]=l.useState(!1),{user:h,signOut:S}=O(),{toast:x}=D(),f=F();l.useEffect(()=>{h||f("/auth")},[h,f]),l.useEffect(()=>{h&&b()},[h]);const b=async()=>{try{const{data:r,error:n}=await y.from("links").select("*").order("created_at",{ascending:!1});if(n)throw n;a(r||[])}catch(r){console.error("Error fetching links:",r),x({title:"Error",description:"Failed to fetch your links",variant:"destructive"})}finally{R(!1)}},E=async r=>{try{const{error:n}=await y.from("links").delete().eq("id",r);if(n)throw n;a(s.filter(U=>U.id!==r)),x({title:"Success",description:"Link deleted successfully"})}catch(n){console.error("Error deleting link:",n),x({title:"Error",description:"Failed to delete link",variant:"destructive"})}},H=r=>{navigator.clipboard.writeText(r),x({title:"Copied!",description:"Link copied to clipboard"})},M=async()=>{await S(),f("/")},_=()=>{u(!1),b()};return t?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{children:"Loading..."})}):e.jsx("div",{className:"min-h-screen bg-background p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"My Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your shortened URLs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{onClick:()=>u(!m),children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),m?"Hide":"Create New"]}),e.jsxs(o,{onClick:M,variant:"outline",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]})]}),m&&e.jsxs(N,{className:"mb-8",children:[e.jsx(g,{children:e.jsx(w,{children:"Create New Short URL"})}),e.jsx(k,{children:e.jsx(B,{onLinkCreated:_})})]}),e.jsxs(N,{children:[e.jsxs(g,{children:[e.jsx(w,{children:"Your Links"}),e.jsxs(z,{children:[s.length," shortened URL",s.length!==1?"s":""]})]}),e.jsx(k,{children:s.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground",children:"No links created yet"}),e.jsxs(o,{onClick:()=>u(!0),className:"mt-4",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Create Your First Link"]})]}):e.jsxs(C,{children:[e.jsx(L,{children:e.jsxs(j,{children:[e.jsx(c,{children:"Short URL"}),e.jsx(c,{children:"Original URL"}),e.jsx(c,{children:"Clicks"}),e.jsx(c,{children:"Created"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(T,{children:s.map(r=>e.jsxs(j,{children:[e.jsxs(d,{className:"font-mono",children:[window.location.hostname,"/",r.slug]}),e.jsx(d,{className:"max-w-xs truncate",children:r.original_url}),e.jsx(d,{children:r.click_count}),e.jsx(d,{children:new Date(r.created_at).toLocaleDateString()}),e.jsx(d,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{size:"sm",variant:"outline",onClick:()=>H(`https://${window.location.host}/${r.slug}`),children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx(o,{size:"sm",variant:"outline",onClick:()=>window.open(r.original_url,"_blank"),children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx(o,{size:"sm",variant:"destructive",onClick:()=>E(r.id),children:e.jsx(Y,{className:"w-4 h-4"})})]})})]},r.id))})]})})]})]})})};export{W as default};
